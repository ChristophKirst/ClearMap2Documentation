
<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Elastix &#8212; ClearMap 2.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/clearmap.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/clearmap_utils.css" />
    <link rel="stylesheet" type="text/css" href="../_static/clearmap_sidebar.css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="https://platform.twitter.com/widgets.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/clearmap.js"></script>
    <script src="../_static/clearmap_sidebar.js"></script>
    <script src="../_static/clearmap_togglebutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Resampling" href="ClearMap.Alignment.Resampling.html" />
    <link rel="prev" title="Annotation" href="ClearMap.Alignment.Annotation.html" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <!--[if lt IE 9]>
  <script src="_static/css3-mediaqueries.js"></script>
  <![endif]-->

  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'/>
   

  </head><body>
<div class="document">
 <div class="imagecontainer">
  <a href="../home.html"><img src="../_static/ClearMap_banner.jpg" height=150px width=150% border="0" alt="ClearMap"/></a>
  <div class="top-left">
    <p style="font-size: 30px"> 
       <a href="../home.html" style="color: #ffffff; font-weight: bold"> ClearMap Documentation </a>
    </p>
  </div>
  <div class="top-right">
    <ul class="link-list">
     <li class="link-list"><a href="../home.html">Home</a></li>
     <li class="link-list"><a href="../overview.html">Overview</a></li>    
     <li class="link-list"><a href="../installation.html">Installation</a></li>
     <li class="link-list"><a href="https://github.com/ChristophKirst/ClearMap2"> <img src="../_static/GitHub-Mark.png" height=16px alt="Github"/> Source</a>
    </ul>
  </div>
  <div class="bottom-right">
    <a href="https://twitter.com/clearmap_idisco?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @clearmap_idisco</a>
      <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>  </a>
  </div>
 </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ClearMap.Alignment.Resampling.html" title="Resampling"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ClearMap.Alignment.Annotation.html" title="Annotation"
             accesskey="P">previous</a> |</li>
       <li><a href="../home.html">Home</a>|&nbsp;</li>
       <li><a href="../overview.html">Overview</a>|&nbsp;</li>      
       <li><a href="../search.html">Search</a>|&nbsp;</li>
       <li><a href="../index.html">Documentation </a> |&nbsp;</li>
       <li><a href="../index.html#clearmap-api">API </a> &raquo;</li>     

          <li class="nav-item nav-item-1"><a href="../api.html" >ClearMap</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="ClearMap.Alignment.html" accesskey="U">Alignment</a> &#187;</li> 
      </ul>
    </div>
<div class="document">
    
    <div class="documentwrapper">
    
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3><a href="../index.html">ClearMap</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functionality.html">Functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wobblystitcher.html">WobblyStitcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cellmap.html">CellMap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CellMap.html">CellMap Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tubemap.html">TubeMap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TubeMap.html">TubeMap Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../media.html">News and Media</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">ClearMap</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="ClearMap.Alignment.html">Alignment</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ClearMap.Alignment.Annotation.html">Annotation</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Elastix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ClearMap.Alignment.Resampling.html">Resampling</a></li>
<li class="toctree-l3"><a class="reference internal" href="ClearMap.Alignment.Stitching.html">Stitching</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ClearMap.Analysis.html">Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="ClearMap.Compile.html">Compile</a></li>
<li class="toctree-l2"><a class="reference internal" href="ClearMap.Environment.html">Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="ClearMap.External.html">External</a></li>
<li class="toctree-l2"><a class="reference internal" href="ClearMap.IO.html">IO</a></li>
<li class="toctree-l2"><a class="reference internal" href="ClearMap.ImageProcessing.html">ImageProcessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="ClearMap.ParallelProcessing.html">ParallelProcessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="ClearMap.Scripts.html">Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="ClearMap.Settings.html">Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="ClearMap.Tests.html">Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="ClearMap.Utils.html">Utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="ClearMap.Visualization.html">Visualization</a></li>
</ul>
</li>
</ul>
 

<h3>Questions? Suggestions?</h3>
<p>Open an issue at the
  <a href="https://github.com/ChristophKirst/ClearMap2/issues">tracker</a>.</p>
  

  <h4>Previous topic</h4>
  <p class="topless"><a href="ClearMap.Alignment.Annotation.html"
                        title="previous chapter">Annotation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ClearMap.Alignment.Resampling.html"
                        title="next chapter">Resampling</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/Api/ClearMap.Alignment.Elastix.rst"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
    
    
    <div class="sphinxsidebar_right" role="navigation" aria-label="right navigation">
      <div class="sphinxsidebarwrapper_right">
        <h3> <a href="../cellmap.html">CellMap Pipeline</a></h3>
          <a href="../cellmap.html">
            <img src="../_static/CellMap_small_fast.gif" width=250px height=140px alt="CellMap"/></a>
        <h3> <a href="../tubemap.html">Tubemap Pipeline</a></h3>
          <a href="../tubemap.html">
            <img src="../_static/TubeMap_raw_movie_small.gif" width=250px height=140px alt="TubeMap"/></a>
        <h3> <a href="../media.html#gallery"> Gallery</a></h3>
          <a href="../media.html#gallery">
            <img src="../_static/TubeMap_graph_movie_small.gif" width=250px height=140px alt="Gallery"/></a> 
        <h3> <a href="../media.html#videos">Social Media and Videos</a></h3>
          <a href="../media.html#videos">   
            <img src="../_static/TEDx.png" width=250px height=70px alt="Videos"/></a>  
      </div>
    </div>
      <!-- sidebar2 --> 
    
    
    <div class="bodywrapper">       
    <div class="body" role="main">
          
  <div class="section" id="elastix">
<h1>Elastix<a class="headerlink" href="#elastix" title="Permalink to this headline">¶</a></h1>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
<span class="target" id="module-ClearMap.Alignment.Elastix"></span><p>Interface to Elastix for alignment of volumetric data.</p>
<p>The elastix documentation can be found <a class="reference external" href="http://elastix.isi.uu.nl/">here</a>.</p>
<p>In essence, a transformation <img class="math" src="../_images/math/b7f9b64acd5d512476e1db97468750a2fd226fda.png" alt="T(x)"/> is sought so that for a fixed image
<img class="math" src="../_images/math/cc3ff71edf439292c71ebdb9854329ee9aac0cdc.png" alt="F(x)"/> and a moving image <img class="math" src="../_images/math/68f385b8208830b802d8ec6d88b316bc6ddd448d.png" alt="M(x)"/>:</p>
<div class="math">
<p><img src="../_images/math/63e05517b1b3e1cff471e2e6b64d00d58c542c42.png" alt="F(x) = M(T(x))"/></p>
</div><p>Once the map <img class="math" src="../_images/math/e8dea8254118f111b5fb20895b03528c17566f06.png" alt="T"/> is estimated via elastix, transformix maps an image
<img class="math" src="../_images/math/34d98ccb7db41d71936030be62b10ed4a1dfa624.png" alt="I(x)"/> from the moving image frame to the fixed image frame, i.e.:</p>
<div class="math">
<p><img src="../_images/math/1468c36ed4c1e4246d8a9f1810ffde9cec2eb6f0.png" alt="I(x) \rightarrow I(T(x))"/></p>
</div><p>To register an image onto a reference image, the fixed image is typically
choosed to be the image to be registered, while the moving image is the
reference image. In this way an object identified in the data at position x
is mapped via transformix as:</p>
<div class="math">
<p><img src="../_images/math/1eaf3c99f1fc9a652f5fb5c5be1e531669918fb5.png" alt="x \rightarrow T(x)"/></p>
</div><div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><p>elastix finds a transformation <img class="math" src="../_images/math/a93d5358f010eac656bc48540d75d681957b5700.png" alt="T: \mathrm{fixed image} \rightarrow \mathrm{moving image}"/></p></li>
<li><p>the fixed image is image to be registered</p></li>
<li><p>the moving image is typically the reference image</p></li>
<li><p>the result folder may contain an image (mhd file) that is <img class="math" src="../_images/math/d976da9accbeae8964255851200ddba648469b37.png" alt="T^{-1}(\mathrm{moving})"/>,
i.e. has the size of the fixed image</p></li>
<li><p>transformix applied to data gives <img class="math" src="../_images/math/fd0a87c2c8d0970ee5cb9e78829d73ac8205e0bd.png" alt="T^{-1}(\mathrm{data})"/> !</p></li>
<li><p>transformix applied to points gives <img class="math" src="../_images/math/b525ed1511b4e4e0e7531842a6f661d01abe237b.png" alt="T(\mathrm{points})"/> !</p></li>
<li><p>point arrays are assumed to be in (x,y,z) coordinates consistent with (x,y,z) array represenation of images in ClearMap</p></li>
</ul>
</div></blockquote>
<p>Main routines are: <a class="reference internal" href="#ClearMap.Alignment.Elastix.align" title="ClearMap.Alignment.Elastix.align"><code class="xref py py-func docutils literal notranslate"><span class="pre">align()</span></code></a>, <a class="reference internal" href="#ClearMap.Alignment.Elastix.transform" title="ClearMap.Alignment.Elastix.transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">transform()</span></code></a>.</p>
<dl class="function">
<dt id="ClearMap.Alignment.Elastix.align">
<code class="sig-name descname">align</code><span class="sig-paren">(</span><em class="sig-param">fixed_image</em>, <em class="sig-param">moving_image</em>, <em class="sig-param">affine_parameter_file</em>, <em class="sig-param">bspline_parameter_file=None</em>, <em class="sig-param">result_directory=None</em>, <em class="sig-param">processes=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#align"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.align" title="Permalink to this definition">¶</a></dt>
<dd><p>Align images using elastix, estimates a transformation <img class="math" src="../_images/math/78612d29991923ed7410fced141c18f794545c25.png" alt="T:"/> fixed image <img class="math" src="../_images/math/8c8a765a28b30e31a1ab27a5df8aed228f8b57fb.png" alt="\rightarrow"/> moving image.</p>
<p class="rubric">Arguments</p>
<dl class="simple">
<dt>fixed_image<span class="classifier">str</span></dt><dd><p>Image source of the fixed image (typically the reference image).</p>
</dd>
<dt>moving_image<span class="classifier">str</span></dt><dd><p>Image source of the moving image (typically the image to be registered).</p>
</dd>
<dt>affine_parameter_file<span class="classifier">str or None</span></dt><dd><p>Elastix parameter file for the primary affine transformation.</p>
</dd>
<dt>bspline_parameter_file<span class="classifier">str or None</span></dt><dd><p>Elastix parameter file for the secondary non-linear transformation.</p>
</dd>
<dt>result_directory<span class="classifier">str or None</span></dt><dd><p>Elastic result directory.</p>
</dd>
<dt>processes<span class="classifier">int or None</span></dt><dd><p>Number of threads to use.</p>
</dd>
</dl>
<p class="rubric">Returns</p>
<dl class="simple">
<dt>result_directory<span class="classifier">str</span></dt><dd><p>Path to elastix result directory.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ClearMap.Alignment.Elastix.check_elastix_initialized">
<code class="sig-name descname">check_elastix_initialized</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#check_elastix_initialized"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.check_elastix_initialized" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if elastix is initialized</p>
<p class="rubric">Returns</p>
<dl class="simple">
<dt>initialized<span class="classifier">bool</span></dt><dd><p>True if elastix paths are set.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ClearMap.Alignment.Elastix.deformation_distance">
<code class="sig-name descname">deformation_distance</code><span class="sig-paren">(</span><em class="sig-param">deformation_field</em>, <em class="sig-param">sink=None</em>, <em class="sig-param">scale=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#deformation_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.deformation_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the distance field from a deformation vector field.</p>
<p class="rubric">Arguments</p>
<dl class="simple">
<dt>deformation_field<span class="classifier">str or array</span></dt><dd><p>Source of the deformation field determined by <a class="reference internal" href="#ClearMap.Alignment.Elastix.deformation_field" title="ClearMap.Alignment.Elastix.deformation_field"><code class="xref py py-func docutils literal notranslate"><span class="pre">deformation_field()</span></code></a>.</p>
</dd>
<dt>sink<span class="classifier">str or None</span></dt><dd><p>Image sink to save the deformation field to.</p>
</dd>
<dt>scale<span class="classifier">tuple or None</span></dt><dd><p>Scale factor for each dimension, if None = (1,1,1).</p>
</dd>
</dl>
<p class="rubric">Returns</p>
<dl class="simple">
<dt>deformation_distannce<span class="classifier">array or st</span></dt><dd><p>Array or file name of the deformation distance data.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ClearMap.Alignment.Elastix.deformation_field">
<code class="sig-name descname">deformation_field</code><span class="sig-paren">(</span><em class="sig-param">sink=[]</em>, <em class="sig-param">transform_parameter_file=None</em>, <em class="sig-param">transform_directory=None</em>, <em class="sig-param">result_directory=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#deformation_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.deformation_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the deformation field T(x) - x.</p>
<p class="rubric">Arguments</p>
<dl class="simple">
<dt>sink<span class="classifier">str, [] or None</span></dt><dd><p>Image sink to save the transformation field; if [] return the default name
of the data file generated by transformix.</p>
</dd>
<dt>transform_parameter_file<span class="classifier">str or None</span></dt><dd><p>Parameter file for the primary transformation, if None, the file is
determined from the transform_directory.</p>
</dd>
<dt>transform_directory<span class="classifier">str or None</span></dt><dd><p>Result directory of elastix alignment, if None the
transform_parameter_file has to be given.</p>
</dd>
<dt>result_directory<span class="classifier">str or None</span></dt><dd><p>The directorty for the transformix results.</p>
</dd>
</dl>
<p class="rubric">Returns</p>
<dl class="simple">
<dt>deformation_field<span class="classifier">array or str</span></dt><dd><p>Array or file name of the deformation field data.</p>
</dd>
</dl>
<p class="rubric">Note</p>
<p>The map determined by elastix is
<img class="math" src="../_images/math/57c17ec2ce7d49bc3edb2ec13febc2d1d8072c97.png" alt="T \mathrm{fixed} \rightarrow \mathrm{moving}"/>.</p>
</dd></dl>

<dl class="function">
<dt id="ClearMap.Alignment.Elastix.initialize_elastix">
<code class="sig-name descname">initialize_elastix</code><span class="sig-paren">(</span><em class="sig-param">path=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#initialize_elastix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.initialize_elastix" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize all paths and binaries of elastix</p>
<p class="rubric">Arguments</p>
<p>path (str or None): path to elastix root directory, if None
<a class="reference internal" href="ClearMap.Settings.html#ClearMap.Settings.elastix_path" title="ClearMap.Settings.elastix_path"><code class="xref py py-const docutils literal notranslate"><span class="pre">ClearMap.Settings.elastix_path</span></code></a> is used.</p>
</dd></dl>

<dl class="function">
<dt id="ClearMap.Alignment.Elastix.inverse_transform">
<code class="sig-name descname">inverse_transform</code><span class="sig-paren">(</span><em class="sig-param">fixed_image</em>, <em class="sig-param">affine_parameter_file</em>, <em class="sig-param">bspline_parameter_file=None</em>, <em class="sig-param">transform_parameter_file=None</em>, <em class="sig-param">transform_directory=None</em>, <em class="sig-param">result_directory=None</em>, <em class="sig-param">processes=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#inverse_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.inverse_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate inverse tranformation <img class="math" src="../_images/math/1a2eeefad54a4391e6a446bac715c99f9352b15e.png" alt="T^{-1}:"/> moving image <img class="math" src="../_images/math/8c8a765a28b30e31a1ab27a5df8aed228f8b57fb.png" alt="\rightarrow"/> fixed image.</p>
<p class="rubric">Arguments</p>
<dl class="simple">
<dt>fixed_image<span class="classifier">str</span></dt><dd><p>Image source of the fixed image (typically the reference image)</p>
</dd>
<dt>affine_parameter_file<span class="classifier">str</span></dt><dd><p>The paramter file for the original affine transformation.</p>
</dd>
<dt>bspline_parameter_file<span class="classifier">str</span></dt><dd><p>The paramter file for the original b-spline transformation.</p>
</dd>
<dt>transform_directory<span class="classifier">str</span></dt><dd><p>Elastic result directory of the original transform.</p>
</dd>
<dt>result_directory<span class="classifier">str or None</span></dt><dd><p>Elastic result directory of the inverse transform.</p>
</dd>
</dl>
<p class="rubric">Returns</p>
<dl class="simple">
<dt>result_directory<span class="classifier">str</span></dt><dd><p>Path to elastix result directory.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ClearMap.Alignment.Elastix.print_settings">
<code class="sig-name descname">print_settings</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#print_settings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.print_settings" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the current elastix configuration.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#ClearMap.Alignment.Elastix.elastix_binary" title="ClearMap.Alignment.Elastix.elastix_binary"><code class="xref py py-const docutils literal notranslate"><span class="pre">elastix_binary</span></code></a>, <a class="reference internal" href="#ClearMap.Alignment.Elastix.elastix_lib" title="ClearMap.Alignment.Elastix.elastix_lib"><code class="xref py py-const docutils literal notranslate"><span class="pre">elastix_lib</span></code></a>, <a class="reference internal" href="#ClearMap.Alignment.Elastix.transformix_binary" title="ClearMap.Alignment.Elastix.transformix_binary"><code class="xref py py-const docutils literal notranslate"><span class="pre">transformix_binary</span></code></a>, <a class="reference internal" href="#ClearMap.Alignment.Elastix.initialized" title="ClearMap.Alignment.Elastix.initialized"><code class="xref py py-const docutils literal notranslate"><span class="pre">initialized</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="ClearMap.Alignment.Elastix.read_points">
<code class="sig-name descname">read_points</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">indices=False</em>, <em class="sig-param">binary=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#read_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.read_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the output points from the output file of transformix</p>
<p class="rubric">Arguments</p>
<dl class="simple">
<dt>filename<span class="classifier">str</span></dt><dd><p>File name of the transformix output file.</p>
</dd>
<dt>indices<span class="classifier">bool</span></dt><dd><p>If True return pixel indices otherwise float coordinates.</p>
</dd>
</dl>
<p class="rubric">Returns</p>
<dl class="simple">
<dt>points<span class="classifier">array</span></dt><dd><p>The point coordinates.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ClearMap.Alignment.Elastix.rescale_size_and_spacing">
<code class="sig-name descname">rescale_size_and_spacing</code><span class="sig-paren">(</span><em class="sig-param">size</em>, <em class="sig-param">spacing</em>, <em class="sig-param">scale</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#rescale_size_and_spacing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.rescale_size_and_spacing" title="Permalink to this definition">¶</a></dt>
<dd><p>Rescales the size and spacing</p>
<p class="rubric">Arguments</p>
<dl class="simple">
<dt>size<span class="classifier">tuple</span></dt><dd><p>The image size.</p>
</dd>
<dt>spacing<span class="classifier">tuple</span></dt><dd><p>The image spacing.</p>
</dd>
<dt>scale<span class="classifier">tuple</span></dt><dd><p>The scale factor.</p>
</dd>
</dl>
<p class="rubric">Returns</p>
<dl class="simple">
<dt>size<span class="classifier">tuple</span></dt><dd><p>The scaled image size.</p>
</dd>
<dt>spacing<span class="classifier">tuple</span></dt><dd><p>The scaled image spacing.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ClearMap.Alignment.Elastix.result_data_file">
<code class="sig-name descname">result_data_file</code><span class="sig-paren">(</span><em class="sig-param">result_directory</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#result_data_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.result_data_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mhd result file in a result directory.</p>
<p class="rubric">Arguments</p>
<dl class="simple">
<dt>result_directory<span class="classifier">str</span></dt><dd><p>Path to elastix result directory.</p>
</dd>
</dl>
<p class="rubric">Returns</p>
<dl class="simple">
<dt>result_file<span class="classifier">str</span></dt><dd><p>The mhd file in the result directory.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ClearMap.Alignment.Elastix.set_elastix_library_path">
<code class="sig-name descname">set_elastix_library_path</code><span class="sig-paren">(</span><em class="sig-param">path=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#set_elastix_library_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.set_elastix_library_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Add elastix library path to the LD_LIBRARY_PATH variable in linux.</p>
<p class="rubric">Arguments</p>
<dl class="simple">
<dt>path<span class="classifier">str or None</span></dt><dd><p>Path to elastix root directory.
If None <a class="reference internal" href="ClearMap.Settings.html#ClearMap.Settings.elastix_path" title="ClearMap.Settings.elastix_path"><code class="xref py py-const docutils literal notranslate"><span class="pre">ClearMap.Settings.elastix_path</span></code></a> is used.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ClearMap.Alignment.Elastix.set_metric_parameter_file">
<code class="sig-name descname">set_metric_parameter_file</code><span class="sig-paren">(</span><em class="sig-param">parameter_file</em>, <em class="sig-param">metric</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#set_metric_parameter_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.set_metric_parameter_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Replaces the metric in the parameter file.</p>
<p class="rubric">Arguments</p>
<dl class="simple">
<dt>parameter_file<span class="classifier">str</span></dt><dd><p>The parameter file name.</p>
</dd>
<dt>metric<span class="classifier">str</span></dt><dd><p>The metric to use.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Used to replace the metric when inverse transform is estimated.</p>
</dd></dl>

<dl class="function">
<dt id="ClearMap.Alignment.Elastix.set_path_transform_files">
<code class="sig-name descname">set_path_transform_files</code><span class="sig-paren">(</span><em class="sig-param">result_directory</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#set_path_transform_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.set_path_transform_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Replaces relative with absolute path in the parameter files in the result directory.</p>
<p class="rubric">Arguments</p>
<dl class="simple">
<dt>result_directory<span class="classifier">str</span></dt><dd><p>Path to directory of elastix results.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>When elastix is not run in the directory of the transformation files
the aboslute path needs to be given in each transformation file
to point to the subsequent transformation files. This is done via this
routine.</p>
</dd></dl>

<dl class="function">
<dt id="ClearMap.Alignment.Elastix.set_transform_file_size_and_spacing">
<code class="sig-name descname">set_transform_file_size_and_spacing</code><span class="sig-paren">(</span><em class="sig-param">transform_file</em>, <em class="sig-param">size</em>, <em class="sig-param">spacing</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#set_transform_file_size_and_spacing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.set_transform_file_size_and_spacing" title="Permalink to this definition">¶</a></dt>
<dd><p>Replaces size and scale in the transformation parameter file</p>
<p class="rubric">Arguments</p>
<dl class="simple">
<dt>transform_file<span class="classifier">str</span></dt><dd><p>Transformation parameter file.</p>
</dd>
<dt>size<span class="classifier">tuple</span></dt><dd><p>The new image size.</p>
</dd>
<dt>spacing<span class="classifier">tuple</span></dt><dd><p>The new image spacing.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ClearMap.Alignment.Elastix.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">source</em>, <em class="sig-param">sink=[]</em>, <em class="sig-param">transform_parameter_file=None</em>, <em class="sig-param">transform_directory=None</em>, <em class="sig-param">result_directory=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform a raw data set to reference using the elastix alignment results.</p>
<p class="rubric">Arguments</p>
<dl class="simple">
<dt>source<span class="classifier">str or array</span></dt><dd><p>Image source to be transformed.</p>
</dd>
<dt>sink<span class="classifier">str, [] or None</span></dt><dd><p>Image sink to save transformed image to. If [] return the default name
of the data file generated by transformix.</p>
</dd>
<dt>transform_parameter_file<span class="classifier">str or None</span></dt><dd><p>Parameter file for the primary transformation.
If None, the file is determined from the transform_directory.</p>
</dd>
<dt>transform_directory<span class="classifier">str or None</span></dt><dd><p>Result directory of elastix alignment.
If None the transform_parameter_file has to be given.</p>
</dd>
<dt>result_directory<span class="classifier">str or None</span></dt><dd><p>The directorty for the transformix results.</p>
</dd>
</dl>
<p class="rubric">Returns</p>
<dl class="simple">
<dt>transformed<span class="classifier">array or st</span></dt><dd><p>Array or file name of the transformed data.</p>
</dd>
</dl>
<p class="rubric">Note</p>
<p>If the map determined by elastix is
<img class="math" src="../_images/math/3a04c3e6f1f69d8ce43bb3ddd5a752e2cc25e652.png" alt="T: \mathrm{fixed} \rightarrow \mathrm{moving}"/>,
transformix on data works as <img class="math" src="../_images/math/fd0a87c2c8d0970ee5cb9e78829d73ac8205e0bd.png" alt="T^{-1}(\mathrm{data})"/>.</p>
</dd></dl>

<dl class="function">
<dt id="ClearMap.Alignment.Elastix.transform_directory_and_file">
<code class="sig-name descname">transform_directory_and_file</code><span class="sig-paren">(</span><em class="sig-param">transform_parameter_file=None</em>, <em class="sig-param">transform_directory=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#transform_directory_and_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.transform_directory_and_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines transformation directory and file from either.</p>
<p class="rubric">Arguments</p>
<dl class="simple">
<dt>transform_parameter_file<span class="classifier">str or None</span></dt><dd><p>File name of the transformation parameter file.</p>
</dd>
<dt>transform_directory<span class="classifier">str or None</span></dt><dd><p>Directory to the transformation parameter.</p>
</dd>
</dl>
<p class="rubric">Returns</p>
<dl class="simple">
<dt>transform_parameter_file<span class="classifier">str</span></dt><dd><p>File name of the transformation parameter file.</p>
</dd>
<dt>transform_directory<span class="classifier">str</span></dt><dd><p>Directory to the transformation parameter.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Only one of the two arguments need to be specified.</p>
</dd></dl>

<dl class="function">
<dt id="ClearMap.Alignment.Elastix.transform_file">
<code class="sig-name descname">transform_file</code><span class="sig-paren">(</span><em class="sig-param">result_directory</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#transform_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.transform_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds and returns the transformation parameter file.</p>
<p class="rubric">Arguments</p>
<dl class="simple">
<dt>result_directory<span class="classifier">str</span></dt><dd><p>Path to directory of elastix results.</p>
</dd>
</dl>
<p class="rubric">Returns</p>
<dl class="simple">
<dt>filename<span class="classifier">str</span></dt><dd><p>File name of the first transformation parameter file.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>In case of multiple transformation parameter files the top level file is
returned.</p>
</dd></dl>

<dl class="function">
<dt id="ClearMap.Alignment.Elastix.transform_file_size_and_spacing">
<code class="sig-name descname">transform_file_size_and_spacing</code><span class="sig-paren">(</span><em class="sig-param">transform_file</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#transform_file_size_and_spacing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.transform_file_size_and_spacing" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the image size and spacing from a transformation parameter file.</p>
<p class="rubric">Arguments</p>
<dl class="simple">
<dt>transform_file<span class="classifier">str</span></dt><dd><p>File name of the transformix parameter file.</p>
</dd>
</dl>
<p class="rubric">Returns</p>
<dl class="simple">
<dt>size: tuple</dt><dd><p>The image size.</p>
</dd>
<dt>spacing<span class="classifier">tuple</span></dt><dd><p>The image spacing.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ClearMap.Alignment.Elastix.transform_points">
<code class="sig-name descname">transform_points</code><span class="sig-paren">(</span><em class="sig-param">source</em>, <em class="sig-param">sink=None</em>, <em class="sig-param">transform_parameter_file=None</em>, <em class="sig-param">transform_directory=None</em>, <em class="sig-param">indices=False</em>, <em class="sig-param">result_directory=None</em>, <em class="sig-param">temp_file=None</em>, <em class="sig-param">binary=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#transform_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.transform_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform coordinates math:<cite>x</cite> via elastix estimated transformation to <img class="math" src="../_images/math/b7f9b64acd5d512476e1db97468750a2fd226fda.png" alt="T(x)"/>.</p>
<p class="rubric">Arguments</p>
<dl class="simple">
<dt>source<span class="classifier">str</span></dt><dd><p>Source of the points.</p>
</dd>
<dt>sink<span class="classifier">str or None</span></dt><dd><p>Sink for transformed points.</p>
</dd>
<dt>transform_parameter_file<span class="classifier">str or None</span></dt><dd><p>Parameter file for the primary transformation.
If None, the file is determined from the transform_directory.</p>
</dd>
<dt>transform_directory<span class="classifier">str or None</span></dt><dd><p>Result directory of elastix alignment.
If None the transform_parameter_file has to be given.</p>
</dd>
<dt>indices<span class="classifier">bool</span></dt><dd><p>If True use points as pixel coordinates otherwise spatial coordinates.</p>
</dd>
<dt>result_directory<span class="classifier">str or None</span></dt><dd><p>Elastic result directory.</p>
</dd>
<dt>temp_file<span class="classifier">str or None</span></dt><dd><p>Optional file name for the elastix point file.</p>
</dd>
</dl>
<p class="rubric">Returns</p>
<dl class="simple">
<dt>points<span class="classifier">array or st</span></dt><dd><p>Array or file name of transformed points.</p>
</dd>
</dl>
<p class="rubric">Note</p>
<p>The transformation is from the fixed image coorindates to the moving
image coordiantes.</p>
</dd></dl>

<dl class="function">
<dt id="ClearMap.Alignment.Elastix.write_points">
<code class="sig-name descname">write_points</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">points</em>, <em class="sig-param">indices=False</em>, <em class="sig-param">binary=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ClearMap/Alignment/Elastix.html#write_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ClearMap.Alignment.Elastix.write_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Write points as elastix/transformix point file</p>
<p class="rubric">Arguments</p>
<dl class="simple">
<dt>filename<span class="classifier">str</span></dt><dd><p>File name of the elastix point file.</p>
</dd>
<dt>points<span class="classifier">array or str</span></dt><dd><p>Source of the points.</p>
</dd>
<dt>indices<span class="classifier">bool</span></dt><dd><p>Write as pixel indices or physical coordiantes.</p>
</dd>
</dl>
<p class="rubric">Returns</p>
<dl class="simple">
<dt>filename: str</dt><dd><p>File name of the elastix point file.</p>
</dd>
</dl>
</dd></dl>

<dl class="data">
<dt id="ClearMap.Alignment.Elastix.elastix_binary">
<code class="sig-name descname">elastix_binary</code><em class="property"> = '/home/ckirst/Programs/ClearMap2/ClearMap/External/elastix/build/bin/elastix'</em><a class="headerlink" href="#ClearMap.Alignment.Elastix.elastix_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>The elastix executable.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>setup in <a class="reference internal" href="#ClearMap.Alignment.Elastix.initialize_elastix" title="ClearMap.Alignment.Elastix.initialize_elastix"><code class="xref py py-func docutils literal notranslate"><span class="pre">initialize_elastix()</span></code></a></p></li>
</ul>
</dd></dl>

<dl class="data">
<dt id="ClearMap.Alignment.Elastix.elastix_lib">
<code class="sig-name descname">elastix_lib</code><em class="property"> = '/home/ckirst/Programs/ClearMap2/ClearMap/External/elastix/build/bin'</em><a class="headerlink" href="#ClearMap.Alignment.Elastix.elastix_lib" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to the elastix library.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>setup in <a class="reference internal" href="#ClearMap.Alignment.Elastix.initialize_elastix" title="ClearMap.Alignment.Elastix.initialize_elastix"><code class="xref py py-func docutils literal notranslate"><span class="pre">initialize_elastix()</span></code></a></p></li>
</ul>
</dd></dl>

<dl class="data">
<dt id="ClearMap.Alignment.Elastix.initialized">
<code class="sig-name descname">initialized</code><em class="property"> = True</em><a class="headerlink" href="#ClearMap.Alignment.Elastix.initialized" title="Permalink to this definition">¶</a></dt>
<dd><p>Status of the elastixs binarys and paths.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>setup in <a class="reference internal" href="#ClearMap.Alignment.Elastix.initialize_elastix" title="ClearMap.Alignment.Elastix.initialize_elastix"><code class="xref py py-func docutils literal notranslate"><span class="pre">initialize_elastix()</span></code></a></p></li>
</ul>
</dd></dl>

<dl class="data">
<dt id="ClearMap.Alignment.Elastix.transformix_binary">
<code class="sig-name descname">transformix_binary</code><em class="property"> = '/home/ckirst/Programs/ClearMap2/ClearMap/External/elastix/build/bin/transformix'</em><a class="headerlink" href="#ClearMap.Alignment.Elastix.transformix_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>The transformix executable.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>setup in <a class="reference internal" href="#ClearMap.Alignment.Elastix.initialize_elastix" title="ClearMap.Alignment.Elastix.initialize_elastix"><code class="xref py py-func docutils literal notranslate"><span class="pre">initialize_elastix()</span></code></a></p></li>
</ul>
</dd></dl>

</div>
</div>

 <!-- body -->
    </div> <!-- body -->
    </div> <!-- bodywrapper -->
    

     
  <!-- mainrow --></div>
<!-- document --></div>
<div class="document" style="background-color: #ffffff; text-align: left; padding: 5px 0px 5px 0px">
<p align="center">
<a href="../overview.html"><img src="../_static/ClearMap_banner.jpg" height=150px width=150% border="0" alt="ClearMap"/></a>
</p>
</div>

    <div class="footer" role="contentinfo">
        &#169; Copyright Copyright © 2020 by Christoph Kirst.
    </div>
  </body>
</html>